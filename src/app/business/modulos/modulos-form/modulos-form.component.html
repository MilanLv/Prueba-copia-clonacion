<div class="container mx-auto px-4 py-6 max-w-2xl">
  <!-- Header -->
  <div class="mb-6">
    <h1 class="text-3xl font-bold text-gray-900">
      {{ isEdit ? 'Editar Módulo' : 'Nuevo Módulo' }}
    </h1>
    <p class="text-gray-600 mt-2">
      {{ isEdit ? 'Modifica la información del módulo' : 'Completa la información para crear un nuevo módulo' }}
    </p>
  </div>

  <!-- Form -->
  <div class="bg-white rounded-lg shadow-md p-6">
    <form [formGroup]="moduloForm" (ngSubmit)="onSubmit()" class="space-y-6">
      <!-- Error Message -->
      <div *ngIf="error" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
        {{ error }}
      </div>

      <!-- Loading -->
      <div *ngIf="loading" class="flex justify-center items-center py-4">
        <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
        <span class="ml-2 text-gray-600">Procesando...</span>
      </div>

      <div *ngIf="!loading" class="space-y-6">
        <!-- Nombre -->
        <div>
          <label for="nombre" class="block text-sm font-medium text-gray-700 mb-2">
            Nombre <span class="text-red-500">*</span>
          </label>
          <input
            id="nombre"
            type="text"
            formControlName="nombre"
            [class]="isFieldInvalid('nombre')
              ? 'w-full px-3 py-2 border border-red-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500'
              : 'w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500'"
            placeholder="Ingresa el nombre del módulo"
          />
          <div *ngIf="isFieldInvalid('nombre')" class="mt-1 text-sm text-red-600">
            {{ getFieldError('nombre') }}
          </div>
        </div>

        <!-- Descripción -->
        <div>
          <label for="descripcion" class="block text-sm font-medium text-gray-700 mb-2">
            Descripción
          </label>
          <textarea
            id="descripcion"
            formControlName="descripcion"
            rows="4"
            class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
            placeholder="Describe el propósito del módulo (opcional)"
          ></textarea>
        </div>

        <!-- Estado Activo -->
        <div>
          <div class="flex items-center">
            <input
              id="activo"
              type="checkbox"
              formControlName="activo"
              class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
            />
            <label for="activo" class="ml-2 block text-sm text-gray-700">
              Módulo activo
            </label>
          </div>
          <p class="mt-1 text-xs text-gray-500">
            Los módulos inactivos no estarán disponibles para asignar permisos
          </p>
        </div>

        <!-- Buttons -->
        <div class="flex justify-end space-x-4 pt-6 border-t border-gray-200">
          <button
            type="button"
            (click)="onCancel()"
            class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
          >
            Cancelar
          </button>
          <button
            type="submit"
            [disabled]="moduloForm.invalid || loading"
            class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"
          >
            <span *ngIf="loading" class="flex items-center">
              <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div>
              {{ isEdit ? 'Actualizando...' : 'Creando...' }}
            </span>
            <span *ngIf="!loading">
              <i [class]="isEdit ? 'fas fa-save mr-2' : 'fas fa-plus mr-2'"></i>
              {{ isEdit ? 'Actualizar Módulo' : 'Crear Módulo' }}
            </span>
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
